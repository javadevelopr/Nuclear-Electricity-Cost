function lwr(e){if(!xp){var t=e.bu1===33?0:e.bu1===43?1:3;var n=FreshLEUTable.map(function(e){return e[t]});xp=n[0]}swu=swu||(2*xp-1)*Math.log(xp/(1-xp))-(2*e.xw-1)*Math.log(e.xw/(1-e.xw))-(xp-e.xw)/(e.xf-e.xw)*((2*e.xf-1)*Math.log(e.xf/(1-e.xf))-(2*e.xw-1)*Math.log(e.xw/(1-e.xw)));mat_flow=e.cr/e.eff1*YR*e.cf1/e.bu1;energy_gen=e.cr*THOU*YHR*e.cf1;var r=e.cc1*e.cr*THOU;var i=e.com1*MILL;var s=e.ir/(Math.pow(1+e.ir,e.tecons)-1);var o=e.cr*(173+.024*(e.cr/e.eff1-1200))/e.cr*s*MILL;s=e.ir/(1-Math.pow(1+e.ir,-e.tecons));var u=(Math.pow(1+e.ir,e.tcons)-1)/(e.ir*e.tcons)*s;var a=e.cwl/THOU;var f=1/(1-e.fff);var l=(xp-e.xw)/(e.xf-e.xw)/(1-e.fswu);var c=1/(1-e.fcon);s=1-Math.pow(1+e.ir,-e.tecons);var h=e.lwrinv*e.cr*e.ir/s;var p=r*u+i;p+=mat_flow*e.c5+energy_gen*a;var d=e.c4+f*swu*e.c3+f*l*e.c2+f*l*c*e.c1;p+=d*h+d*mat_flow+o;return p*100/energy_gen}function fr(e){if(!fpusf){var t=e.bu1===33?0:e.bu1===43?1:3;var n=[0,.25,.5,.75,.99].indexOf(e.frcr);var r=FRTable.map(function(e){return e[n]});var i=SpentLEUTable.map(function(e){return e[t]});fpusf=i.slice(3,9).reduce(function(e,t){return e+t});frenr=r[1];frcreff=r[2]}mat_flow=e.cr/e.eff1*YR*e.cf1/e.bu1;energy_gen=e.cr*THOU*YHR*e.cf1;var s=e.cs+e.bu1*e.cfpcond/THOU+e.rb;var o=fpusf*(1-e.freppu)*1.1;var u=(1-e.fdrvpu)/(e.cf2*YR/e.eff2*(frenr/e.bu2-(frenr/e.bu2-(1-frcreff)/THOU)*(1-e.frdrvpu)*(1-e.fdrvpu)));var a=e.ir/(1-Math.pow(1+e.ir,0-e.tecons));var f=e.frtruinv*(e.ff1/frenr+e.c2*(1/frenr-1))*a;var l=e.cf2*THOU*YHR;var c=e.frtruinv/(1-e.fdrvpu)*a;var h=e.cf2*YR/e.eff2*(frcreff/THOU+((1-frenr)/e.bu2-frcreff/THOU)*(e.frdrvpu+(1-e.frdrvpu)*e.fdrvpu));var p=Math.pow(1+e.ir,e.tcons)-1;var d=Math.pow(1+e.ir,e.tecons)-1;var v=p/(e.ir*e.tcons)*a*e.cc2*THOU;var m=(197+.024*(e.cr/e.eff2-1200))*e.eff1/e.eff2/e.cr*e.ir/d*MILL;var g=e.com2*MILL/e.cr;var y=e.cf2*YR/e.eff2/e.bu2;var b=e.fr1+e.bu2*e.cfpcond/THOU+e.rb;var w=-e.cwl/THOU;var E=mat_flow*o;var S=E*u;var x=S*f;var T=mat_flow*s;var N=h*e.c2+(v+m+g)+y*b+y*e.ff1;var C=w*energy_gen;T+=S*N+C;T+=S/E*(mat_flow*s+C)*c+S*f;return T*100/(S*l)}function mox(e){if(!f239mox){var t=e.bu1===33?0:e.bu1===43?1:3;var n=[33,43,53].indexOf(e.bu3);var r=FreshMoxTable[t];var i=r.map(function(e){return e[n]});f239mox=i[4];var s=SpentLEUTable.map(function(e){return e[t]});f239sf=s[4]}mat_flow=e.cr/e.eff1*YR*e.cf1/e.bu1;energy_gen=e.cr*THOU*YHR*e.cf1;var o=-e.cwl/THOU;var u=f239sf*(1-e.freppu)*(1-e.fmoxpu)/f239mox;var a=e.cs+e.bu1*e.cfpcond/THOU+e.rb;var f=e.ir/(1-Math.pow(1+e.ir,-e.tecons));var l=e.lwrinv*f;var c=1-f239mox;var h=e.bu3*e.eff1*THOU*24;var p=e.cwl/THOU;var d=1/(e.cf1*THOU*YHR);var v=Math.pow(1+e.ir,e.tcons)-1;var m=v/(e.ir*e.tcons)*f*e.cc1*THOU;var g=e.com1*MILL/e.cr;var y=Math.pow(1+e.ir,e.tecons)-1;var b=(173+.024*(e.cr/e.eff1-1200))/e.cr*e.ir/y*MILL;var w=energy_gen*o;var E=mat_flow*u;var S=mat_flow*a;var x=E*c*e.c2;var T=E*e.c5;var N=w+S+x;var C=N+E*e.cb1;var k=E*h*d;N=C*l/E*k;N+=E*h*p;N+=T+C+k*m;N+=k*g;N+=k*b;return N/(E*h)*100}function boxmuller(e,t,n){var r,i,s,o;do{r=Math.random()*2-1;i=Math.random()*2-1;s=r*r+i*i}while(s>=1);s=Math.sqrt(-2*Math.log(s)/s);o=r*s;if(n)return Math.pow(Math.E,e+o*t);return e+o*t}function __djb2(e){var t=5381;for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);t=(t<<5)+t+r}return t}var FreshLEUTable=[[.0325,.037,.044],[0,0,0],[.9675,.963,.956]];var xp=null,swu=null,mat_flow=null,energy_gen=null;var FRTable=[[0,.25,.5,.75,.999],[.986,.56,.333,.212,.139],[0,.28,.56,.82,.999]];var SpentLEUTable=[[.00884,.0076,.0076],[.00391,.00481,.00594],[.94372,.9325,.91983],[12e-5,21e-5,33e-5],[.0054,.00572,.00607],[.00221,.00262,.00291],[.00132,.0016,.00182],[45e-5,68e-5,85e-5],[3e-5,5e-5,6e-5],[.966,.95579,.9455]];var fpusf=frenr=frcreff=mat_flow=f239sf=energy_gen=null;var SpentLEUTable=[[.00884,.0076,.0076],[.00391,.00481,.00594],[.94372,.9325,.91983],[12e-5,21e-5,33e-5],[.0054,.00572,.00607],[.00221,.00262,.00291],[.00132,.0016,.00182],[45e-5,68e-5,85e-5],[3e-5,5e-5,6e-5],[.966,.95579,.9455]];var FreshMoxTable={0:[[.00213,.00212,.00209],[0,0,0],[.94632,.93871,.92667],[7e-4,8e-4,96e-5],[.03019,.03465,.04172],[.01215,.01394,.01679],[.0055,.00631,.0076],[54e-5,62e-5,74e-5],[1.00001,1,1]],1:[[NaN,.0021,.00207],[NaN,0,0],[NaN,.93053,.91631],[NaN,.00129,.00156],[NaN,.03678,.04457],[NaN,.01659,.0201],[NaN,.00768,.00931],[NaN,.00428,.00519],[NaN,75e-5,91e-5],[NaN,1,1.00002]],2:[[NaN,NaN,NaN],[NaN,NaN,NaN],[NaN,NaN,NaN],[NaN,NaN,NaN],[NaN,NaN,NaN],[NaN,NaN,NaN],[NaN,NaN,NaN],[NaN,NaN,NaN],[NaN,NaN,NaN],[NaN,NaN,NaN]]};var f239mox=f239sf=mat_flow=energy_gen=null;var YR=365.25,YHR=365.25*24,THOU=1e3,MILL=1e6;self.onmessage=function(e){var t=e.data.model;var n=parseInt(e.data.n);var r=e.data.params;var i=e.data.modelState;var s=e.data.returnParams;if(t==="lwr")run=lwr;else if(t==="fr")run=fr;else if(t==="mox")run=mox;else return;var o=[];for(var u=0;u<n;u++){var a={},f={};for(var l in r){var c=r[l];if(i==="D"||!c.std)a[l]=+c.value;else if(c.dist&&c.dist==="log"){f[l]=a[l]=boxmuller(Math.log(+c.value),+c.std,true)}else f[l]=a[l]=boxmuller(+c.value,+c.std)}if(s){o.push({v:run(a),d:a,nid:__djb2(JSON.stringify(f))})}else o.push(run(a))}self.postMessage({results:o})}